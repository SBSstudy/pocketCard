<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper
	namespace="com.example.demo.repository.CardRepository">
	
	<select id="getCardList" resultType="com.example.demo.vo.Card" parameterType="Map">
		SELECT * FROM questionCard
		<where>
			`writerId`=#{memberId} AND
			<if test="learningStatus >= 0">
				`learningStatus`=#{learningStatus} AND
			</if>
			<if test="answerHideStatus >= 0">
				`answerHideStatus`=#{answerHideStatus} AND
			</if>
			<if test="searchKeyword != null">
				CONCAT(`title`, `body`) LIKE CONCAT('%', #{searchKeyword}, '%') AND
			</if>
			<if test="hashTagArr != null">
				<foreach collection="hashTagArr" item="hashTag" separator="AND">
					`tagStatus` LIKE CONCAT('%', #{hashTag}, '%')
				</foreach>
			</if>
		</where>
	</select>
	
	<insert id="doWriteCard" parameterType="com.example.demo.dto.ForWriteCard">
		INSERT INTO `questioncard` 
			( 
			`writerId`, 
			`title`, 
			`body`, 
			`learningStatus`, 
			`answerStatus`, 
			`tagStatus`, 
			`regDate`, 
			`updateDate`
			)
			VALUES
			( 
			#{writerId}, 
			#{title}, 
			#{body}, 
			#{learningStatus}, 
			#{answerStatus}, 
			#{tagStatus}, 
			NOW(), 
			NOW()
			);
	</insert>

</mapper>
